# 区块链相关术语



## 1. 基础词

### 1.1 区块链

意味着用纯代码为交易信任背书，区块链可以视作一个保存着交易凭证的完美账本，区块里面记录的所有数据都是以环环相扣的。

在区块链这个大账本里面，**每个区块都是账本的一页**，第二页记录了第一页最重要的一些内容，第三页又记录了第二页最重要的一些内容。依此类推，那么黑客如果需要修改某一个账单，则需要将后面的每一页一起篡改。

并且，区块链的账本**不属于某个人保管**，而是拥有无限份“拷贝”，分给区块链网络里面所有人**共同保管**，成为难以篡改的超级数据库。

- 区块链整体性
- 区块链的分布性



### 1.2 去中心化

- 区块链不会受到某个组织或个人的控制
- 区块链不会因为某个人的离开而崩溃

因为交易信息被一页页环环相扣的添加到了一本**在线账本**上，链上每个人都保管着这个账本备份，共同来见证这笔交易，所以你不用担心别人赖账，交易变得去中心化。而基于同样的原理，区块链用于数据存储也是。



### 1.3 私有链

私有链式由单一一家公司搭建的区块链，它隶属于公司内部，被记录在这条链上的信息也都是关于公司自己的事物。私有链账本虽然保存在不同人手里，但是他们都属于同一个组织，所以不是完全的去中心化的。



### 1.4 联盟链

一些列利益相关者组成联盟，联盟内的交易都被记录，账本也是分发的。但联盟链中**话语权可能不同**，同时与私有链类似，也不完全是去中心化的。



### 1.5 公有链

大量匿名公众参与者共同维护的一条链，**比特币就是目前最著名的一个公有链**。



### 1.6 区块

区块是区块链的基本组成单元，里面存储着一条条数据。

写在区块信息最上方的内容，被称为区块头，其中存储的信息虽然非常少，但记录着上一个区块头的信息概要，以及本区块的信息概要。区块头类似乐高中的突起，用于**链接**区块。而其中的内容，又类似美剧里面的前情提要+本级看点。**但是每个区块不会包含下一个区块的信息，因为那个区块完全没发生**。

通过区块头虽然**不能索引区块中的具体信息**，但是可以快速验证**某条信息是否被包含在该区块中**。



### 1.7 挖矿

先假定你是一个发起了比特币转账交易的交易者。首先，发起交易的软件会将这条交易信息广播到区块链网络里，但并不意味着交易就立刻被添加到了区块链上，而是**漂浮**在区块链网络中。

所以交易的接收方会发现比特币**不是实时到账的**，而是需要等待一段时间才能到账。

why？因为区块链是一条数据链，每一个区块都是塞满交易数据的“盒子”。某位矿工选中了你的交易，必须找到一个区块将它**封装起来**，交易才可能被链接到区块链上。

然而，装数据的**盒子**并不是现成的，矿工们可以看到区块链上一个个塞满了交易的“老区块”，而新区块的挖掘就是**挖矿**的过程。

所以**挖出比特币准确来说**，就是指**矿工挖出新区块后，领走比特币奖励**。

竞争规则：新区块中区块头的绝大部分信息都是可以计算获知的，但是需要找到一个数字，是将这个**数字和区块头其它信息**进行**哈希**之后，得到的数值**小于**软件给出的数值，其实也就是相当于掷色子。



### 1.8 **共识机制**

究竟由谁来添加账本内容：这就需要一个共识机制

常见的共识机制包括：Proof of Work (PoW), Proof of Stake (PoS), Delegated Proof of Stake (DPoS)

- PoW：比特币使用的PoW，破解竞争规则难题与否取决于**算力大小**
- PoS：通常是公有链，影响结果的关键因素是**持有加密货币的数量**和**持有时长**
- DPoS：代议制民主的以为，通过参与者投票，选出有权添加新区块的代表团

不同的共识机制目的都是维护区块链网络的安全运行，手段也同样是通过**经济激励**，因为只有当维护区块链网络比攻击它更能获得巨大回报时，参与者才会放弃捣乱。



### 1.9 以太坊

以太坊的技术方案是，可以将各种应用程序的代码像交易记录那样存储在以太坊网络中，详单与开发团队可以基于以太坊提供的服务来打造一个个区块链应用程序。

比如：网约车服务通常需要一个平台来连接乘客和司机，为什么即使它会抽取中介费我们也需要这个平台？本质上是因为平台构建了乘客和司机之间的信任。需要这样一个平台来记录司机的身份，降低他作恶的几率，而乘客也会收到平台的约束。支付的中介费，其实就是信任成本。

而如果现在一个团队使用了以太坊网络提供的**模板**开发了一个区块链打车app，乘客和司机将能建立点对点连接，加密货币将被用于直接向司机支付车费。交易的结果被记录在以太坊网络上。乘客和司机的个人信息也将存储在以太坊网络中，由全部参与者共同保管。



### 1.10 智能合约

本质上就是一个代码拟定的合同，预先写好了合同参与方应该履行的承诺，而这份合同所约定的内容就是由代码**自动执行的**。

当区块链和智能合约结合，就可以很简单的建立其信任。因为区块链使得智能合约不能被随意篡改，而到了约定情况，智能合约又能自动执行。



### 1.11 通证（Token）

token是需要依附在比特币，以太坊这样的网络上发行和运行的。而这个token，可以在一定场景下被使用作为替换以太币的结算的，如果使用token进行结算，那么**智能合约**就会记录下token的**使用情况**。矿工们会把**智能合约的每一个动态**，都记录下来。塞入一个block里面，连接到以太坊网络中。（既记录下这笔交易）、

这也是为什么Token在此语境下也被称为**代币**的原因。因为原来使用比特币之类的情况，为了不记账，是需要跑整条区块链来确认交易的。但使用代币之后，相当于token的使用情况被记录下来，而不是直接当作消费被记录下来。



## 2. 区块链的运作机制

### 2.1 矿机

矿机被用来计算一道道复杂的数学题，挖矿就是挖掘这些问题的答案。而挖到正确答案，就会获得比特币奖励。



### 2.2 记账

区块链就是一条数据链，本身就可以视作是一个大账本。但特殊的是，并没有一个类似银行那样的中心机构来为交易做记录。

而区块链中，矿工往**新区块**中塞入**交易数据**，并连接到区块链上的做法，称之为**记账**。

为什么本身不是中心机构的矿工，是可靠的记账人呢？这是因为当一个矿工挖出新区块并在其中塞满交易数据，其它矿工避免将自己的区块添加在非法区块后面，会**验证**这个区块是否真的符合挖矿的**游戏规则**，里面的**交易是否合法**等。

另一方面，当你发起一笔交易时，需要支付一定的费用给矿工的。



### 2.3 矿工

它们既是每一个区块的挖掘者，以及将交易信息封存到区块链网络中的操作者。他们同时还是区块链网络**完整账本**的保管者，正是由他们来负责查验每一笔订单的**合法性**。



### 2.4 算力

区块链中的算力，就是狭义的为：计算哈希值的能力。 



### 2.5 难度动态调整

中本聪规定了，BTC每两个新区块诞生的时间间隔，**恒定在10分钟左右**，也就是挖出新区块消耗的时间大致在一个恒量范围。这其中就需要难度进行动态调整。



### 2.6 孤块

当多个矿工同时挖出新区块的时候，哪一个矿工广播自己挖出的区块更快，也就跟可能链接上新区块，也就更可能真正得到这个收益。



### 2.7 空块

矿工们总是竭力的在一个区块中塞入尽量多的交易数据。这是因为塞入的交易越多，矿工费总和就越高。

但情况是，如果另一个矿工挖掘出了新区块，你只能先下载别人挖出的新区块，看清楚里面有哪些交易，因为这些交易不能被重复的塞入下一个区块中。因为如果你挖掘出了新区块，但是填入的交易无法通过别的矿工的验证，那么你也无法获得收益。

这时候就会出现，如果我认为进行验证别人打包的区块内的交易是负责麻烦的，但是我挖掘到了新区块链，这时候只赚新区块的钱，不赚记录交易的钱。就会出现空块的诞生。



### 2.8 工作量证明机制PoW

几乎是纯粹的算力PK



### 2.9 权益证明机制PoS

只允许持有该加密货币的人，才能参与竞选新区块的添加权。但是这会导致马太效应。



### 2.10 股份授权证明机制DPoS

Delegated Proof of Stake，是一种引用了选举概念的共识机制。每个持币者不直接参与添加新区块，而是投票给候选人。正确到最多票数的候选人们，可以作为代表团，然后轮流添加新区块。



### 2.11 交易

比特币的交易实际上是发起了一条请求，包含**你的转币地址，对方的收笔地址，金额，以及数字签名**。每当一个加密货币交易信息被塞入区块，连接到区块链上，那么有人的账户余额就会发生变动。而在以太坊上，这个不一定是交易，可以是一些参数，区块链记录这些参数。



## 3. 区块内部微观世界
### 3.1 区块高度

是指某一个区块到**第一个区块**之间的距离，通过区块高度，可以精确的描述出某一区块在链上的位置，相当于给了区块一个**坐标**，第一个区块高度为0。



### 3.2 SHA-256

英文全称是Secure Hash Algorithm，安全哈希算法，SHA-256是指一种哈希值的固定长度，是二进制256位的算法。



### 3.3 梅克尔树（Merkle Trees）

密码学应用中，很少直接将一个数据哈希一次，因为一旦传输过程中数据损坏，很难定位究竟哪一部分出了问题。

通常解决办法是切割数据，变成一个个小的数据块，每个数据块分别hash一次，然后相邻的数据库得出的hash值，再放到一起hash一次。如果数据块数目为奇数，则自动复制一笔交易。两两hash，直到产生最后一个hash值。

在比特币应用中，为了便于查验区块中哪条交易被改动，会使用Merkle trees这种数据结构来**记录区块中的所有交易**。一旦区块中某条记录被改动，就会跟Merkle Trees的root中的hash值出现冲突。



### 3.4 简单支付认证（Simplified Payment Verification）

SPV是一种相对简单的、用来验证支付的方法。

你发送的交易信息经过hash，这个被称为**交易ID**的hash值你是拥有的，验证这个交易是否存在，就需要将你的交易ID发送给附近的矿工，让他在完整账本中帮你找到这条记录所在的区块。

但是为了确保没有矿工会撒谎，你需要下载**区块头账本**（BTC每个区块的容量是1048576字节，而区块头只有80字节），然后询问矿工，与你这条**交易ID相邻的其它交易的ID（也就是hash值，不需要知道相邻交易具体内容）**，然后通过一层层计算hash的hash值，最终得到Merkle Trees的Root的hash值，只要是与你下载的区块头账本相同，就可以确认这个交易一定发生了。



###  3.5 盲签名

无记名投票。盲签名一般设计两种角色：公证人和投票人。投票人首先将将自己投票以及自己身份信息打包成一个信息，然后对信息进行盲化，处理之后再交给公证人进行盲签名。



### 3.6 环签名

用自己的私钥，和一群人的公钥，共同进行了签名。**验证者只需要用签名中的任何一个人的公钥，都能验证这份签名的真实性**。**但却无法知道，究竟是谁对这份文件进行了签名**。



### 3.7 多重签名

通常类似于共同账户，**实现约定了有哪些人参与签名，多少人共同签名才能生效等问题**，创建交易后，需要到达原先的约定，交易才能成功。

同时，**一个人也可以创建一个多重签名账户**。



### 3.8 数字证书

**用来证明，你是你，的证件**。由于某个人用的公钥在传输过程中可能被截获并替换，结果变成了某个中间人发送了他自己的公钥，然后你用他的公钥进行签名，那么他自己的私钥就可以解密并获得信息了。所以，通常公钥都是会传输给CA（数字证书认证机构），然后人们获取对方公钥，都是往CA处获取的，就可以确保某个公钥，确实是你的通信对方拥有的。



### 3.9 钱包

加密货币钱包（通常所谓的软钱包），**保存的不是数字资产，而是一个密钥**。真正的**数字资产是保存在区块链账本中的数据**。人们是通过这个密钥（私钥），来证明数字货币资产的归属问题。这种私钥，通常是**通过算法随机生成的**。

当一个人向你发起转账时，**你的钱包公钥，就会生产一个给你打款的“地址”，当他通过这个地址将数字货币打入钱包，只有拥有私钥的你才能取用**。

所以，一旦丢失了私钥，你的数字资产也相当于永久丢失了。



### 3. 10 热钱包

金融领域里面的热，是指流动性很高，活动频繁的特性。这里的**热钱包**，通常是指**连接网络的，在线的钱包**。



### 3.11 冷钱包

就是**离线的钱包**。



### 3.12 助记词

是私钥的另一种展现形式，其隐私性与私钥同等重要。（通常就是英文）



### 3.13 节点

下载了区块链上所有数据的，才能算得上节点。它们能**独立地验证**所收到的每笔交易，并判断**这笔交易的发起者，是否有足够的余额可供支出**。同时，他们还负责**验证的交易塞到新区块中**。下载全部区块链完整数据的称之为**全节点**（截至2020年2月，比特币的全部数据大小接近256G），而只下载了全部区块头数据的节点，称之为**轻节点**（256G数据，区块头仅有47MB）。

通常轻节点，需要借助全节点的数据，才能**查询某个交易是否已经被添加到区块中**。



### 3.14 未花费的交易支出UTXO

这是BTC的一种记账方式。与银行中的对账户余额进行加减法不同，BTC使用的这种交易方式，每次花费都会**废除原来的UTXO，产生全新的UTXO，作废和新产生的记录都会被保存在区块中，所以可以追溯每一条UTXO的来源**。

另一方面，**UTXO模式下，你每次接受别人转给你的钱，都可以使用不同的地址**。如果某一个地址受到了监控，但是用来接受其它币的地址依然位置。重点是**UTXO的所有地址，由于都是使用同一个你的公钥生成的，所以都只能是你的一个单独的私钥能使用**。



## 4. 外部利益

### 4.1 51%攻击

因为BTC永远只认可最长链路，所以**如果一个人先使用比特币进行交易，然后按照记账原理，这条信息被连接到了区块链最新的一个区块上。接着，然后在记录这个信息的上一个块上，迅速添加新区块，只要他添加区块的速度足够快，就能成功打造新的最长链。这样一来，上一笔交易花费的钱又回到了自己手上，从而实现双花**。根据概率学统计，如果一个人拥有51%全网算力，那么他一定能做到。而拥有30%的时候，也有一定概率能做到。



### 4.2 双重支付

例如一个人在极短的时间内，花费了BTC，然后矿工还没来得及将这笔交易添加到区块上，然后他又马上使用同一个BTC进行了另一笔支付。那么最后添加上区块链之后，其中一笔交易就会作废。

**所以，一笔交易通常需要多个确认，才能确保交易不被作废**。如果一条交易记录，还没被塞入区块，那么就是没有确认。塞入区块，且这个区块后面又有一个新区块了，称之为2个确认。确认越多，也就证明这个交易越不可能被作废。



### 4.3 重放攻击
利用重复广播相同交易的消息（主要在于硬分叉事件，在2017年，从原来的BTC分叉到了一个BTH比特币现金的新链路。原来有多少BTC的人，在新链路上就有多少个BTH）。由于一个BTC和一个BTH的地址，密钥，交易格式都一样，你可能只想用BTH进行交易，但是同时等量的BTC也被转出。

还有就是，以太坊由于没有使用UTXO记账机制，所以会有重放攻击的出现。



### 4.4 重放攻击保护

硬分叉后的重放攻击保护，重点在于需要让一条链路上的交易信息，需要在另一条链路上失效。

而内部重放攻击通常有两种保护方式：

- 在交易时间上加上时间戳
- 为交易添加序列号（以太坊就为每个账户添加一个数值，每发出一笔交易就+1）



### 4.5 女巫攻击

通过单点伪造出多个身份进行网络欺诈的攻击方式。比特币采用的PoW机制下这种攻击是无效的。但使用投票等机制的就会受到冲击。



### 4.6 粉尘攻击

区块链网络中的粉尘，泛指大量小额交易。攻击者可以使用大量无意义的小额交易，导致网络传递大量信息。由于**每个区块的容量都是有限的，能够容纳的交易都是有限的。那么会导致大量的交易停留在网络中，同时还有大量粉尘漂浮，那么真正的交易可能需要等待很长时间才能生效。（而且插入区块之后还有等待多几个区块才能确认）**

另外一种粉尘攻击，是攻击者能看到某个地址存在大量的比特币，然后通过向这个地址交易0.00000001个BTC。随后，它就跟踪这个新生成的UTXO中关联到你地址的信息。随后，由于这个BTC太小，你某次花费BTC刚好用上这0.00000001个BTC和别的BTC凑单，那么这时候你的另一个凑单的BTC的地址也被发现了。慢慢就可以缩小找寻的范围，最后被真实世界被定位，也就失去了BTC具有的匿名性。



### 4.7 分叉

由于BTC的具体实现是开源的，每个人都可以看到其中细节如何实现，所以人们也可以对其进行修改。这里的修改主要是对客户端的修改，因为比特币中的交易转账，矿工挖矿等规则，都是通过软件客户端的代码来约定的。有时候可能因为效率或安全原因，对一些协议进行更新，这里更新的就是客户端，而**发布一次新版本的软件协议，就被称为分叉一次**。

而由于去中心化的原则，不是每次跟新都强制所有客户端都必须进行更新，所以网络中是可能存在多种新旧协议下的交易的。



### 4.8 软分叉

如果旧协议下产生的一笔交易是能被判定为合法的，那么就是软分叉，新旧协议达到了兼容。



### 4.9 硬分叉

例如比特币现金，就是一种硬分叉出来的，希望无限扩容区块大小的，不能兼容旧协议的新协议。



### 4.10 隔离见证SegWit

SegWit就是Segregated Witness，隔离见证，是用来扩大比特币区块容量的方案。

这里所谓的**见证**，是指矿工使用的这个信息，用以验证转账发起人是否**有权**使用这笔资金。而隔离见证，则是指把见证信息，隔离出来，不纳入区块容量。



### 4.11 SegWit2x

主要思想是想为闪电网络埋下伏笔，即大量小额交易不放到区块链上，而是通过形式在**链下**进行处理，但同时也会减少了矿工的收入。同时，闪电网络是某种中心化的处理。这个也是BTH硬分叉出来的导火索。



### 4.12 闪电网络

如果说SegWit是类似餐厅的拼桌，而闪电网络则类似专门给一个外卖窗口。实际上，使用闪电网络需要双方都下载带有闪电网络功能的钱包，然后选择开启闪电网络，相当于开辟了一条仅供双方使用的快速转账通道。它是一个类似资金池的东西，使用它需要首先打入一些BTC。而矿工，只会将你打开通道时存入的金额，以及关闭时的账户余额分配信息打包塞入区块中，而不需要将你们的**每一笔交易**都计入区块中，所以在一笔笔具体交易进行的过程中，基本可以实时到账。

由于不上链，所以存在欺诈的可能，因此它有不少反欺诈的手段（主要是惩罚）。也就是说，闪电网络这样的理念，是把部分交易**分流到线下**。



### 4.13 状态通道

闪电网络其实就是状态通道的一种实现，因为状态通道的理念，也是希望短时间内发生多次交易状态变更的时候，只更新成最终态。



### 4.14 同态哈希

同态哈希可以保证，如果将一本书分成两个部分进行哈希，然后两个值加起来，能够与将一整本书哈希出来的哈希值，相同。



### 4.15 零知识证明

区块链交易对网络中的任何人都是可见的，而零知识证明可以让一笔资产转移的同时，兼顾隐私。不仅验证交易的矿工无法知道交易信息，网络中的其它人也只知道发生了一笔验证过的交易。但是**交易参与者的身份，和交易金额，会被隐藏**。



## 5. 过去事件和现在时

### 5.1 DAO

DAO是 Decentralized Autonomous Organization 的缩写，也就是去中心化自治组织。

而 The DAO 通常是特指建立在以太坊上的DApp。



### 5.2 主链和侧链

例如以以太坊为主链的电影链，就是修改了部分参数，并且使用智能合约等进行与以太币进行货币互换，成功为电影等特殊内容进行了上链。



### 5.3 跨链技术

一种为两条或多条区块链之间提供价值转移的技术。当你发起币转token的请求时，智能合约会帮助撮合，并让双方同时提币。



### 5.4 分片

例如发布了一条交易，原本是由整个网络的矿工负责验证、转发和存储，现在运用了分片技术，这条交易会按照某种规则（例如交易ID的最后一位是多少），被划分到某一个片区的节点处理。

于此同时，还需要考虑片区之间的实时交流。例如使用了1BTC购买了一件商品，这笔交易被划分到了片区1，而又马上购买了另一间商品，被划分到了片区2，这样就需要片区1和2进行实时交流。

